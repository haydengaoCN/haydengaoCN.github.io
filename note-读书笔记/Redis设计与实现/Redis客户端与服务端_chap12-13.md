# 1 - 客户端

似乎没什么有意思的内容。

# 2 - 服务器

* 一条命令请求从发送到完成主要包括以下几个步骤：

  1）客户端将命令请求发送到服务器；

  2）服务器读取命令请求，并分析出命令参数（从套接字中读出命令和状态到输入缓冲区）；

  3）命令执行器根据参数查找命令的实现函数，然后执行实现函数并得出命令回复；

  4）服务器将命令回复给客户端。

* `serverCron` 函数

  每隔 100ms 执行一次，其主要工作包括：

  1）更新服务器状态信息（更新服务器时间缓存、更新 LRU 时钟、服务器每秒执行命令次数、内存峰值）；

  2）处理服务器接收的 SIGTERM 信号（关闭之前进行 RDB 持久化操作）；

  3）管理客户端资源和数据库状态（客户端连接是否超时、输入缓冲区大小，过期键删除、字典收缩）；

  4）检查并执行持久化操作等。

* 服务器启动过程

  1）初始化服务器状态；

  2）载入服务器配置；

  3）初始化服务器数据结构；

  4）还原数据库状态；

  5）执行事件循环，开始接收处理请求。

